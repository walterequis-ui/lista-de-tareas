<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista de Tareas con Prioridades</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            padding: 20px;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .container {
            display: flex;
            flex-direction: column;
            width: 100%;
            max-width: 1000px;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            position: relative;
        }
        
        @media (min-width: 768px) {
            .container {
                flex-direction: row;
            }
        }
        
        .main-content {
            flex: 3;
            padding: 25px;
        }
        
        .favorites-sidebar {
            flex: 1;
            background-color: #f8f9fa;
            padding: 25px;
            border-left: 1px solid #eee;
        }
        
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        h1 {
            color: #333;
            margin-right: 15px;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            padding: 8px 12px;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .logo-text {
            font-size: 16px;
            line-height: 1.2;
            text-align: center;
        }
        
        .logo-accent {
            font-size: 18px;
            color: #ffc107;
        }
        
        h2 {
            color: #444;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #6a11cb;
        }
        
        .input-section {
            display: flex;
            margin-bottom: 25px;
            gap: 10px;
        }
        
        #nueva-tarea {
            flex: 1;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        #nueva-tarea:focus {
            border-color: #6a11cb;
            outline: none;
        }
        
        #agregar-btn {
            padding: 15px;
            width: 50px;
            height: 50px;
            background: linear-gradient(to right, #6a11cb, #2575fc);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 24px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s, background 0.3s;
        }
        
        #agregar-btn:hover {
            transform: scale(1.1);
            background: linear-gradient(to right, #580fb8, #1c67e8);
        }
        
        #lista-tareas, #lista-favoritos {
            list-style-type: none;
            margin-bottom: 20px;
        }
        
        .tarea {
            display: flex;
            align-items: center;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            background-color: #f8f9fa;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            animation: fadeIn 0.5s;
            transition: all 0.3s;
            border: 3px solid #28a745; /* Verde por defecto (sin prioridad) */
            cursor: pointer;
        }
        
        .tarea.alta-prioridad {
            border-color: #dc3545; /* Rojo para alta prioridad */
            background-color: #fff5f5;
        }
        
        .tarea.media-prioridad {
            border-color: #ffc107; /* Amarillo para media prioridad */
            background-color: #fff9e6;
        }
        
        .tarea:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .tarea.completada .texto-tarea {
            text-decoration: line-through;
            color: #888;
        }
        
        .checkbox-tarea {
            margin-right: 15px;
            width: 22px;
            height: 22px;
            cursor: pointer;
        }
        
        .texto-tarea {
            flex: 1;
            font-size: 16px;
            word-break: break-word;
        }
        
        .btn-favorito {
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
            margin: 0 10px;
            color: #ccc;
            transition: color 0.3s, transform 0.2s;
        }
        
        .btn-favorito:hover {
            transform: scale(1.2);
        }
        
        .btn-favorito.favorito {
            color: #ffc107;
        }
        
        .btn-eliminar {
            background: none;
            border: none;
            color: #dc3545;
            font-size: 18px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .btn-eliminar:hover {
            transform: scale(1.2);
        }
        
        .favorite-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background-color: white;
            border-radius: 8px;
            margin-bottom: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .favorite-item:hover {
            background-color: #e9ecef;
            transform: translateX(5px);
        }
        
        .btn-eliminar-favorito {
            background: none;
            border: none;
            color: #dc3545;
            font-size: 16px;
            cursor: pointer;
            margin-left: 10px;
            transition: transform 0.2s;
        }
        
        .btn-eliminar-favorito:hover {
            transform: scale(1.2);
        }
        
        .vacio {
            text-align: center;
            color: #888;
            padding: 20px;
            font-style: italic;
        }
        
        .info-text {
            background-color: #e9ecef;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            font-size: 14px;
            color: #495057;
        }
        
        .alert-message {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #ffc107;
            color: #856404;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: slideIn 0.3s forwards, fadeOut 0.5s forwards 2.5s;
        }
        
        .warning-message {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #dc3545;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: slideIn 0.3s forwards, fadeOut 0.5s forwards 2.5s;
        }
        
        .success-message {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #28a745;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: slideIn 0.3s forwards, fadeOut 0.5s forwards 2.5s;
        }
        
        .priority-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            z-index: 1001;
            display: none;
            flex-direction: column;
            gap: 15px;
            width: 300px;
        }
        
        .priority-modal h3 {
            margin: 0;
            color: #333;
            text-align: center;
        }
        
        .priority-options {
            display: flex;
            justify-content: space-between;
            gap: 10px;
        }
        
        .priority-btn {
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            flex: 1;
        }
        
        .priority-btn.alta {
            background-color: #dc3545;
            color: white;
        }
        
        .priority-btn.media {
            background-color: #ffc107;
            color: #333;
        }
        
        .priority-btn.ninguna {
            background-color: #28a745;
            color: white;
        }
        
        .priority-btn:hover {
            opacity: 0.9;
            transform: scale(1.05);
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
        }
        
        @keyframes slideIn {
            from {
                top: -50px;
                opacity: 0;
            }
            to {
                top: 20px;
                opacity: 1;
            }
        }
        
        @keyframes fadeOut {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
                visibility: hidden;
            }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .sort-info {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
            color: #6c757d;
            margin-top: 5px;
        }
        
        .priority-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 10px;
            flex-shrink: 0;
        }
        
        .priority-indicator.alta {
            background-color: #dc3545;
        }
        
        .priority-indicator.media {
            background-color: #ffc107;
        }
        
        .priority-indicator.ninguna {
            background-color: #28a745;
        }
        
        .press-hint {
            font-size: 12px;
            color: #6c757d;
            margin-top: 5px;
            text-align: center;
        }
        
        .tarea-actions {
            display: flex;
            align-items: center;
        }
        
        @media (max-width: 767px) {
            .favorites-sidebar {
                border-left: none;
                border-top: 1px solid #eee;
            }
            
            .input-section {
                flex-direction: row;
            }
            
            .header-container {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .logo-container {
                margin-top: 10px;
                align-self: flex-end;
            }
            
            .tarea {
                padding: 12px;
            }
            
            .btn-favorito, .btn-eliminar {
                margin: 0 5px;
            }
        }

        @media (max-width: 480px) {
            .header-container {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }
            
            h1 {
                margin-right: 0;
                margin-bottom: 10px;
            }
            
            .logo-container {
                align-self: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="main-content">
            <div class="header-container">
                <h1>Lista de Tareas</h1>
                <div class="logo-container">
                    <div class="logo-text">
                        <span class="logo-accent">e</span><br>
                        LafiX<br>
                        <small>Nuestra meta<br>es tu éxito</small>
                    </div>
                </div>
            </div>
            
            <div class="input-section">
                <input type="text" id="nueva-tarea" placeholder="Escribe una nueva tarea...">
                <button id="agregar-btn">+</button>
            </div>
            
            <div class="info-text">
                <i class="fas fa-info-circle"></i> Haz doble clic en cualquier tarea para cambiar su prioridad
            </div>
            
            <ul id="lista-tareas">
                <!-- Las tareas se agregarán aquí dinámicamente -->
            </ul>
        </div>
        
        <div class="favorites-sidebar">
            <h2>Tareas Favoritas</h2>
            <div class="info-text">
                <i class="fas fa-info-circle"></i> Haz clic en cualquier tarea para agregarla automáticamente a la lista principal.
                <div class="sort-info">
                    <i class="fas fa-sort-alpha-down"></i> Ordenadas alfabéticamente
                </div>
            </div>
            
            <ul id="lista-favoritos">
                <!-- Las tareas favoritas se agregarán aquí dinámicamente -->
            </ul>
        </div>
    </div>

    <!-- Modal para seleccionar prioridad -->
    <div class="modal-overlay" id="priority-overlay"></div>
    <div class="priority-modal" id="priority-modal">
        <h3>Seleccionar prioridad</h3>
        <div class="priority-options">
            <button class="priority-btn alta" data-priority="alta">Alta</button>
            <button class="priority-btn media" data-priority="media">Media</button>
            <button class="priority-btn ninguna" data-priority="ninguna">Ninguna</button>
        </div>
        <p class="press-hint">El borde de la tarea cambiará de color según la prioridad</p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const inputTarea = document.getElementById('nueva-tarea');
            const btnAgregar = document.getElementById('agregar-btn');
            const listaTareas = document.getElementById('lista-tareas');
            const listaFavoritos = document.getElementById('lista-favoritos');
            const priorityModal = document.getElementById('priority-modal');
            const priorityOverlay = document.getElementById('priority-overlay');
            const priorityButtons = document.querySelectorAll('.priority-btn');
            
            let tareas = [];
            let favoritos = [];
            let currentTaskId = null;
            
            // Cargar tareas y favoritos desde localStorage al iniciar
            cargarDatos();
            
            // Función para mostrar mensaje de alerta
            function mostrarAlerta(mensaje, tipo = 'info') {
                // Eliminar alerta existente si hay una
                const alertaExistente = document.querySelector('.alert-message, .warning-message, .success-message');
                if (alertaExistente) {
                    alertaExistente.remove();
                }
                
                const alerta = document.createElement('div');
                if (tipo === 'warning') {
                    alerta.className = 'warning-message';
                } else if (tipo === 'success') {
                    alerta.className = 'success-message';
                } else {
                    alerta.className = 'alert-message';
                }
                
                alerta.innerHTML = `
                    <i class="fas ${tipo === 'warning' ? 'fa-exclamation-triangle' : tipo === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'}"></i>
                    <span>${mensaje}</span>
                `;
                
                document.body.appendChild(alerta);
                
                // Eliminar la alerta después de 3 segundos
                setTimeout(() => {
                    if (alerta.parentNode) {
                        alerta.parentNode.removeChild(alerta);
                    }
                }, 3000);
            }
            
            // Función para mostrar el modal de prioridad
            function mostrarModalPrioridad(taskId) {
                currentTaskId = taskId;
                priorityModal.style.display = 'flex';
                priorityOverlay.style.display = 'block';
            }
            
            // Función para ocultar el modal de prioridad
            function ocultarModalPrioridad() {
                priorityModal.style.display = 'none';
                priorityOverlay.style.display = 'none';
                currentTaskId = null;
            }
            
            // Event listeners para los botones de prioridad
            priorityButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    if (currentTaskId) {
                        const prioridad = this.dataset.priority;
                        cambiarPrioridad(currentTaskId, prioridad);
                        ocultarModalPrioridad();
                        mostrarAlerta(`Prioridad establecida como ${prioridad}`, 'success');
                    }
                });
            });
            
            // Event listener para cerrar el modal al hacer clic fuera
            priorityOverlay.addEventListener('click', ocultarModalPrioridad);
            
            // Función para cambiar la prioridad de una tarea
            function cambiarPrioridad(id, prioridad) {
                tareas = tareas.map(tarea => {
                    if (tarea.id === id) {
                        tarea.prioridad = prioridad;
                    }
                    return tarea;
                });
                
                localStorage.setItem('tareas', JSON.stringify(tareas));
                
                // Actualizar la interfaz
                const elemento = document.querySelector(`.tarea[data-id="${id}"]`);
                if (elemento) {
                    // Remover clases de prioridad existentes
                    elemento.classList.remove('alta-prioridad', 'media-prioridad');
                    
                    // Añadir la clase correspondiente a la nueva prioridad
                    if (prioridad === 'alta') {
                        elemento.classList.add('alta-prioridad');
                    } else if (prioridad === 'media') {
                        elemento.classList.add('media-prioridad');
                    }
                    
                    // Actualizar el indicador visual
                    const indicator = elemento.querySelector('.priority-indicator');
                    if (indicator) {
                        indicator.classList.remove('alta', 'media', 'ninguna');
                        indicator.classList.add(prioridad);
                    }
                }
            }
            
            // Función para agregar una nueva tarea
            function agregarTarea() {
                const texto = inputTarea.value.trim();
                
                if (texto === '') {
                    mostrarAlerta('Por favor, escribe una tarea', 'warning');
                    return;
                }
                
                // Verificar si ya existe en la lista principal (incluyendo completadas)
                const textoNormalizado = texto.toLowerCase();
                const yaExiste = tareas.some(tarea => 
                    tarea.texto.toLowerCase() === textoNormalizado
                );
                
                if (yaExiste) {
                    mostrarAlerta('Esa tarea ya existe en tu lista', 'warning');
                    return;
                }
                
                // Crear elemento de tarea
                const tarea = {
                    id: Date.now(),
                    texto: texto,
                    completada: false,
                    favorita: false,
                    prioridad: 'ninguna' // Prioridad por defecto
                };
                
                // Guardar en localStorage
                guardarTarea(tarea);
                
                // Crear elemento en la lista
                crearElementoTarea(tarea);
                
                // Mostrar mensaje de confirmación
                mostrarAlerta(`"${texto}" agregada correctamente`, 'success');
                
                // Limpiar input
                inputTarea.value = '';
                inputTarea.focus();
            }
            
            // Event listener para el botón agregar
            btnAgregar.addEventListener('click', agregarTarea);
            
            // Event listener para la tecla Enter
            inputTarea.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    agregarTarea();
                }
            });
            
            // Función para crear elemento de tarea en el DOM
            function crearElementoTarea(tarea) {
                const li = document.createElement('li');
                li.classList.add('tarea');
                li.setAttribute('data-id', tarea.id);
                
                // Aplicar clase de prioridad si existe
                if (tarea.prioridad === 'alta') {
                    li.classList.add('alta-prioridad');
                } else if (tarea.prioridad === 'media') {
                    li.classList.add('media-prioridad');
                }
                
                if (tarea.completada) {
                    li.classList.add('completada');
                }
                
                li.innerHTML = `
                    <div class="priority-indicator ${tarea.prioridad}"></div>
                    <input type="checkbox" class="checkbox-tarea" ${tarea.completada ? 'checked' : ''}>
                    <span class="texto-tarea">${tarea.texto}</span>
                    <div class="tarea-actions">
                        <button class="btn-favorito ${tarea.favorita ? 'favorito' : ''}">
                            <i class="fas fa-star"></i>
                        </button>
                        <button class="btn-eliminar">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </div>
                `;
                
                // Event listener para doble click (cambiar prioridad)
                let clickTimer = null;
                li.addEventListener('dblclick', function(e) {
                    // Evitar que se active si se hace clic en elementos interactivos
                    if (e.target.closest('.checkbox-tarea') || 
                        e.target.closest('.btn-favorito') || 
                        e.target.closest('.btn-eliminar')) {
                        return;
                    }
                    
                    mostrarModalPrioridad(tarea.id);
                });
                
                // Event listener para el checkbox
                const checkbox = li.querySelector('.checkbox-tarea');
                checkbox.addEventListener('change', function() {
                    toggleCompletada(tarea.id, this.checked);
                    li.classList.toggle('completada');
                    
                    if (this.checked) {
                        mostrarAlerta(`"${tarea.texto}" marcada como completada`, 'success');
                    }
                });
                
                // Event listener para el botón favorito
                const btnFavorito = li.querySelector('.btn-favorito');
                btnFavorito.addEventListener('click', function() {
                    const esFavorita = !tarea.favorita;
                    
                    // Verificar si ya existe en favoritos
                    const textoNormalizado = tarea.texto.trim().toLowerCase();
                    const yaExiste = favoritos.some(fav => 
                        fav.texto.trim().toLowerCase() === textoNormalizado
                    );
                    
                    if (esFavorita && yaExiste) {
                        mostrarAlerta('Esta tarea ya está entre las favoritas', 'warning');
                        return;
                    }
                    
                    toggleFavorita(tarea.id, esFavorita);
                    btnFavorito.classList.toggle('favorito', esFavorita);
                    
                    if (esFavorita) {
                        mostrarAlerta(`"${tarea.texto}" agregada a favoritos`, 'success');
                    } else {
                        mostrarAlerta(`"${tarea.texto}" eliminada de favoritos`);
                    }
                    
                    cargarFavoritos();
                });
                
                // Event listener para el botón eliminar
                const btnEliminar = li.querySelector('.btn-eliminar');
                btnEliminar.addEventListener('click', function(e) {
                    e.stopPropagation();
                    
                    if (confirm(`¿Estás seguro de que quieres eliminar la tarea "${tarea.texto}"?`)) {
                        // No eliminamos la tarea de favoritos al borrarla de la lista principal
                        eliminarTarea(tarea.id);
                        li.remove();
                        verificarListaVacia();
                        mostrarAlerta(`"${tarea.texto}" eliminada correctamente`);
                    }
                });
                
                listaTareas.appendChild(li);
                verificarListaVacia();
            }
            
            // Función para agregar tarea desde favoritos
            function agregarDesdeFavoritos(textoTarea, id) {
                // Verificar si ya existe en la lista principal (solo tareas no completadas)
                const textoNormalizado = textoTarea.toLowerCase();
                const yaExiste = tareas.some(tarea => 
                    tarea.texto.toLowerCase() === textoNormalizado && !tarea.completada
                );
                
                if (yaExiste) {
                    mostrarAlerta('Esa tarea ya existe en tu lista', 'warning');
                    return;
                }
                
                // Crear elemento de tarea
                const tarea = {
                    id: Date.now(),
                    texto: textoTarea,
                    completada: false,
                    favorita: false,
                    prioridad: 'ninguna'
                };
                
                // Guardar en localStorage
                guardarTarea(tarea);
                
                // Crear elemento en la lista
                crearElementoTarea(tarea);
                
                // Mostrar mensaje de confirmación
                mostrarAlerta(`"${textoTarea}" agregada desde favoritos`, 'success');
            }
            
            // Función para ordenar favoritos alfabéticamente
            function ordenarFavoritos() {
                favoritos.sort((a, b) => {
                    const textoA = a.texto.toLowerCase();
                    const textoB = b.texto.toLowerCase();
                    
                    if (textoA < textoB) return -1;
                    if (textoA > textoB) return 1;
                    return 0;
                });
                
                // Guardar el orden en localStorage
                localStorage.setItem('favoritos', JSON.stringify(favoritos));
            }
            
            // Función para cargar favoritos
            function cargarFavoritos() {
                // Ordenar favoritos alfabéticamente
                ordenarFavoritos();
                
                listaFavoritos.innerHTML = '';
                
                if (favoritos.length === 0) {
                    const mensaje = document.createElement('li');
                    mensaje.classList.add('vacio');
                    mensaje.textContent = 'No hay tareas favoritas';
                    listaFavoritos.appendChild(mensaje);
                    return;
                }
                
                favoritos.forEach(tarea => {
                    const li = document.createElement('li');
                    li.classList.add('favorite-item');
                    li.innerHTML = `
                        <span>${tarea.texto}</span>
                        <div>
                            <button class="btn-eliminar-favorito">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    `;
                    
                    // Event listener para agregar automáticamente al hacer clic en la tarea
                    li.addEventListener('click', function(e) {
                        // Evitar que se active si se hace clic en el botón de eliminar
                        if (!e.target.closest('.btn-eliminar-favorito')) {
                            agregarDesdeFavoritos(tarea.texto, tarea.id);
                        }
                    });
                    
                    // Event listener para eliminar de favoritos
                    const btnEliminar = li.querySelector('.btn-eliminar-favorito');
                    btnEliminar.addEventListener('click', function(e) {
                        e.stopPropagation();
                        
                        if (confirm(`¿Eliminar "${tarea.texto}" de favoritos?`)) {
                            eliminarFavorito(tarea.id);
                            mostrarAlerta(`"${tarea.texto}" eliminada de favoritos`);
                        }
                    });
                    
                    listaFavoritos.appendChild(li);
                });
            }
            
            // Función para guardar tarea en localStorage
            function guardarTarea(tarea) {
                tareas.push(tarea);
                localStorage.setItem('tareas', JSON.stringify(tareas));
            }
            
            // Función para cargar datos al iniciar
            function cargarDatos() {
                // Cargar tareas
                const tareasData = localStorage.getItem('tareas');
                tareas = tareasData ? JSON.parse(tareasData) : [];
                
                // Cargar favoritos
                const favoritosData = localStorage.getItem('favoritos');
                favoritos = favoritosData ? JSON.parse(favoritosData) : [];
                
                if (tareas.length === 0) {
                    mostrarMensajeVacio();
                } else {
                    tareas.forEach(tarea => {
                        crearElementoTarea(tarea);
                    });
                }
                
                cargarFavoritos();
            }
            
            // Función para cambiar estado de completada
            function toggleCompletada(id, completada) {
                tareas = tareas.map(tarea => {
                    if (tarea.id === id) {
                        tarea.completada = completada;
                    }
                    return tarea;
                });
                
                localStorage.setItem('tareas', JSON.stringify(tareas));
            }
            
            // Función para cambiar estado de favorita
            function toggleFavorita(id, esFavorita) {
                tareas = tareas.map(tarea => {
                    if (tarea.id === id) {
                        tarea.favorita = esFavorita;
                        
                        // Agregar o quitar de favoritos
                        if (esFavorita) {
                            // Verificar si ya existe en favoritos
                            const existeEnFavoritos = favoritos.some(fav => fav.id === id);
                            if (!existeEnFavoritos) {
                                // Crear una copia para evitar referencia al objeto original
                                const tareaFavorita = {...tarea};
                                favoritos.push(tareaFavorita);
                            }
                        } else {
                            // Eliminar de favoritos
                            favoritos = favoritos.filter(fav => fav.id !== id);
                        }
                    }
                    return tarea;
                });
                
                localStorage.setItem('tareas', JSON.stringify(tareas));
                localStorage.setItem('favoritos', JSON.stringify(favoritos));
                
                // Recargar favoritos para mantener el orden alfabético
                cargarFavoritos();
            }
            
            // Función para eliminar tarea de la lista principal
            function eliminarTarea(id) {
                // No eliminamos la tarea de favoritos al borrarla de la lista principal
                tareas = tareas.filter(tarea => tarea.id !== id);
                localStorage.setItem('tareas', JSON.stringify(tareas));
            }
            
            // Función para eliminar tarea de favoritos
            function eliminarFavorito(id) {
                favoritos = favoritos.filter(tarea => tarea.id !== id);
                localStorage.setItem('favoritos', JSON.stringify(favoritos));
                
                // Actualizar estado en la lista principal si la tarea todavía existe
                tareas = tareas.map(tarea => {
                    if (tarea.id === id) {
                        tarea.favorita = false;
                    }
                    return tarea;
                });
                localStorage.setItem('tareas', JSON.stringify(tareas));
                
                // Recargar favoritos
                cargarFavoritos();
                
                // Actualizar UI de la lista principal
                const elementoFavorito = document.querySelector(`.tarea[data-id="${id}"] .btn-favorito`);
                if (elementoFavorito) {
                    elementoFavorito.classList.remove('favorito');
                }
            }
            
            // Función para verificar si la lista está vacía
            function verificarListaVacia() {
                const tareasIncompletas = tareas.filter(tarea => !tarea.completada);
                
                if (tareasIncompletas.length === 0) {
                    mostrarMensajeVacio('No hay tareas pendientes. ¡Agrega una!');
                } else {
                    const mensajeVacio = document.getElementById('mensaje-vacio');
                    if (mensajeVacio) {
                        mensajeVacio.remove();
                    }
                }
            }
            
            // Función para mostrar mensaje de lista vacía
            function mostrarMensajeVacio(mensaje) {
                if (document.getElementById('mensaje-vacio')) return;
                
                const li = document.createElement('li');
                li.classList.add('vacio');
                li.textContent = mensaje;
                li.id = 'mensaje-vacio';
                listaTareas.appendChild(li);
            }
        });
    </script>
</body>
</html>